# 네트워크 계층 : 목적지에 데이터 전달하기
데이터 링크 계층에서는 이더넷 규칙을 기반으로 데이터의 전송을 담당하는데, 이 규칙에 따라 같은 네트워크에 있는 컴퓨터로는 데이터를 전송할 수 있지만, 인터넷이나 다른 네트워크로는 데이터를 전송할 수 없다.

따라서 서로 다른 네트워크에 있는 목적지로 데이터를 전달하려면 네트워크 계층의 기술이 필요하다

### OSI모델 3계층인 네트워크 계층의 이해
* IP
* 라우터
* IP 주소
* 서브넷
* 라우팅

## 1) IP
IP(Internet Protocol)

네트워크 계층을 통해 데이터를 전송하려면 라우터라는 네트워크 장비가 필요하고, 다른 네트워크에 보내기 위해 네트워크를 식별할 수 있는 주소가 필요한데 이를 IP주소라고 한다.
    
    IP주소란 어떤 네트워크의 어떤 컴퓨터인지를 구분할 수 있도록 하는 주소이다.
    이 IP주소가 있으면 다른 네트워크에 있는 목적지를 지정할 수 있다.

네트워크 계층에서 캡슐화할 때 IP 헤더를 붙인다.
버젼, 헤더길이, 서비스 유형, 전체 패킷 길이, ID, 조각 상태, 조각의 위치, TTL, 프로토콜, 헤더 체크섬, **출발지 IP 주소**, **목적지 IP 주소** 가 있다.

이처럼 IP프로토콜을 사용하여 캡슐화할 때는 데이터에 IP 헤더가 추가되는데, 이렇게 만들어진 것을 **IP패킷**이라고 한다. 

## 2) 라우터
원하는 목적지를 IP 주소로 지정하는 것뿐만 아니라 데이터를 어떤 경로로 보내맂도 결정해야 한다. 이처럼 목적지 IP 주소까지 어던 경로로 데이터를 보낼지 결정하는 것을 **라우팅** 이라고 한다.

라우팅은 라우터라는 자이가 한다.
라우터에는 라우팅 테이블이 있어서 경로 정보를 등록하고 관리한다.

## 3) IP 주소
IP 버젼에는 IPv4 와 IPv6가 있다. IPv4는 32비트로 되어 있어서 약 43억개의 IP주소를 만들 수 있는데 지금은 인터넷이 널리 보급되면서 IP주소가 부족해졌고 그러면서 IPv6 주소를 사용하게 되었다. IPv6는 128비트로 되어 있어서 IPv4 주소보다 많은 IP주소를 만들 수 있다. (약 340간 개. 사실상 무한대)

IP주소는 32비트로 구분하기 쉽게 10진수로 표시한다

1100000010101000000000010001010

이를 읽기 쉽게 1옥텟(8비트)씩 자르면

11000000|10101000|00000001|0001010 이 된다.

이를 10진수로 표시하면

`192.168.1.10` 처럼 읽기 쉬운 숫자가 된다.

또한 이 아이피 주소는 네트워크 ID와 호스트ID로 나뉘어 진다.

네트워크 ID는 어떤 네트워크인지를 나타내고, 호스트 ID는 해당 네트워크의 어느 컴퓨터인지를 나타낸다.

이 두가지 정보가 합쳐져서 IP 주소가 된다.


## 4) 서브넷
일반적으로 IP주소는 A,B,C 클래스로 나누어져 있다.
A클래스는 네트워크 ID가 8비트에 호스트 ID가 24비트고 , B클래스는 네트워크 ID가 16비트에 호스트 ID가 16비트고, C클래스는 네트워크 ID가 24비트에 호스트 ID가 8비트이다.

예를 들어 A클래스는 호스트 ID가 24비트여서 IP주소를 1677만 7214개 사용할 수 있다.

위와같이 많은 수의 네트워크 주소에서 브로드캐스트 패킷을 전송한다면 모든 컴퓨터에 패킷이 전송되고 네트워크가 혼잡해질 것이다.

이를 방지하기 위해 A클래스의 대규모 네트워크를 작은 네트워크로 분할하여 브로드캐스트로 전송되는 패킷의 범위를 좁힐 수 있다. 

이처럼 네트워크를 분할하는 것을 `서브넷팅`이라고 하고, 분할된 네트워크를 `서브넷`이라고 한다.

## 5) 라우팅
서로 다른 네트워크와 통신하려면 라우터가 필요하고
라우팅은 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 토애 데이터를 전송하는 방식이다.

경로 정보가 등록되어 있는 테이블을 라우팅 테이블이라고 한다.

라우터 간에 라우팅 정보를 서로 교환하기 위한 프로토콜을 라우팅 프로토콜이라고 한다.

